---
- name: Ping localhost
  hosts: all
  gather_facts: yes

  tasks:
  - name: Just ping
    ping:

  - name: Show current greeting
    debug:
      msg: "greeting: {{ greeting | default('greeting is undefined') }} "
   
  - name: Set a custom fact
    set_fact:
      cacheable: yes
      foo: bar
      greeting: "{{ new_greeting | default('') }}"
      another: one

  - name: Show new greeting
    debug:
      msg: "greeting: {{ greeting }}"
      
  - name: Show greeting from hostvars
    debug:
      msg: "greeting: {{ hostvars[inventory_hostname]['greeting'] }}"
